#Deep Joint CSI Feedback and Multiuser Precoding for MIMO OFDM Systems

**"Deep Joint CSI Feedback and Multiuser Precoding for MIMO OFDM Systems" [[arXiv]]([https://arxiv.org/abs/2404.16289](https://arxiv.org/abs/2404.16289)) proposed a joint CSI feedback and precoding network.** If our work is helpful for your research, we would hope you give us a star and citation. Thanks!

This repository contains the implementation code for paper:

**1. Deep Joint CSI Feedback and Multiuser Precoding for MIMO OFDM Systems [[arXiv]](https://arxiv.org/abs/2404.16289)**  
**2. Deep Learning for CSI Feedback: One-Sided Model and Joint Multi-Module Learning Perspectives [[arXiv]](https://arxiv.org/abs/2405.05522)**
## Abstract

The design of precoding plays a crucial role in achieving a high downlink sum-rate in multiuser multiple-input multiple-output (MIMO) orthogonal frequency-division multiplexing (OFDM) systems. In this correspondence, we propose a deep learning based joint CSI feedback and multiuser precoding method in frequency division duplex systems, aiming at maximizing the downlink sum-rate performance in an end-to-end manner. Specifically, the eigenvectors of the CSI matrix are compressed using deep joint source-channel coding techniques. This compression method enhances the resilience of the feedback CSI information against degradation in the feedback channel. A joint multiuser precoding module and a power allocation module are designed to adjust the precoding direction and the precoding power for users based on the feedback CSI information. Experimental results demonstrate that the downlink sum-rate can be significantly improved by using the proposed method, especially in scenarios with low signal-to-noise ratio and low feedback overhead.


## Dependencies
* tensorflow (>=2.5)
* numpy
* argparse
* scipy


## Install

###  Data set processing
1. For the CSI feature vector dataset: each sample is normalized and stored as an .npz file, and the stored data includes the training dataset, validation dataset, test dataset, and the normalization factors of the three. The data sets are stored in the data_npz folder
 Corresponding file: data_pro_CSI.py
2. Processing the uplink channel: normalize each sample, equivalent to amplifier processing, and store the data including the training dataset, the validation dataset, the test dataset and the normalization factors of the three. The dataset exists in the folder data_npz
 corresponding file: data_pro_2D_H_ul.py
3. Processing of the downlink CSI at the RB level: normalization is done for each sample, equivalent to an amplifier. This dataset is used to calculate the downlink channel capacity. The data stored includes the training dataset, validation dataset, test dataset and the normalization factors of all three. The dataset is present in the folder data_npz
 Corresponding file: data_pro_Hdl_RB.py

### JFPNet network test
Modify the dataset location to point to your own dataset (.npz file). Modify ed (compressed CSI dimension), snr_low (uplink signal-to-noise ratio in dB), snr_high (uplink signal-to-noise ratio in dB), P_sum (downlink transmit power), and noise_power (downlink full bandwidth noise power) in the file for training.

 The current network is the case of 2 users, when increasing the number of users need to modify the data loading and network framework part, refer to the two users can be.

 Corresponding code: MU_seperate_DJSCC_net2_PA.py:DJSCC network+JMP_+ PA module

### Traditional Algorithms
 BD_max_R_perfect_CSI.mat: perfect feedback, full channel state information
 BD_max_R_part_CSI.mat: DJSCC + BD based on partial channel state information, storing BD precoding followed by precoding vector
 NN_with_BD_part_CSI: BD+PF
 origin_V_to_BD_Ms: perfect feedback, use partial CSI to generate precoding moments
 water_filling_with_BD_origin_V: perfect feedback + BD+WF
 water_filling_with_BD_part_CSI: DJSCC+BD+WF, using precoded vectors generated by BD_max_R_part_CSI.mat to do the waterfilling and compute the downstream and rate

### SFPNet network test
 First train the DJSCC network, just use the DJSCC network in ADJSCC.
 Then train the precoding module, using stage2_JMP.py.
 Finally, do the test using stage3_test_JFPNet.py.

### dataset
We provide a small training set test, test set and validation set for reference in the folder named "data_npz". The larger dataset can be obtained by connecting the authors of the paper.

## Citation

If you are interested in our repository and our paper, please cite the following paper:

```
@ARTICLE{guo2024deepjointcsifeedback,
       author = {{Guo}, Yiran and {Chen}, Wei and {Xu}, Jialong and {Li}, Lun and {Ai}, Bo},
        title = {{Deep koint CSI feedback and multiuser precoding for MIMO OFDM systems}},
      journal = {arXiv e-prints},
     keywords = {Computer Science - Information Theory, Electrical Engineering and Systems Science - Signal Processing},
         year = 2024,
        month = apr,
          eid = {arXiv:2404.16289},
        pages = {arXiv:2404.16289},
          doi = {10.48550/arXiv.2404.16289},
archivePrefix = {arXiv},
       eprint = {2404.16289},
 primaryClass = {cs.IT},
       adsurl = {https://ui.adsabs.harvard.edu/abs/2024arXiv240416289G},
      adsnote = {Provided by the SAO/NASA Astrophysics Data System}
}

@article{guo2024deep,
  title={Deep Learning for CSI Feedback: One-Sided Model and Joint Multi-Module Learning Perspectives},
  author={Guo, Yiran and Chen, Wei and Sun, Feifei and Cheng, Jiaming and Matthaiou, Michail and Ai, Bo},
  journal={arXiv preprint arXiv:2405.05522},
  year={2024}
}
```
